//PERSISTENCE OF VISION PROJECT persistenceofvisionproject.com
//AUTHOR: JESÚS VICENTE PINPANPLOT@GMAIL.COM 2017
//Persistence of Vision Project by Jesús Vicente is licensed under a Creative Commons Reconocimiento 4.0 Internacional License.
$(".c2")["hide"]();$("#divbluetooth")["hide"]();$("#divProgreso")["hide"]();$(".numrad")["hide"]();$(".animate")["hide"]();$(".ledtipe")["hide"]();$(".numpixel")["hide"]();var coloroption=11;var bcoloroption=11;var numpasos=0;var numpasos180=[];var stepoption=1;var animation=0;var vbrillo=127;var anguloini=0;var c1=document["createElement"]("canvas");var ctx=c1["getContext"]("2d");c1["width"]= 500;c1["height"]= 500;var c2=document["createElement"]("canvas");var ctx2=c2["getContext"]("2d");c2["width"]= 500;c2["height"]= 500;var img= new Image();var numLED=30;var size=500;ctx["webkitImageSmoothingEnabled"]= false;ctx["imageSmoothingEnabled"]= false;img["onload"]= pixelate;img["src"]= "1.png";var myImage2;var myImage2Polar=[];var PolarRedu=[];var ledColor=[];var w;var h;var invertir=false;var cambiangulo=false;var anguloreducido=999;numLED= idnumleds["value"];document["getElementById"]("myinputOff1")["max"]= numLED;document["getElementById"]("myinputOff2")["max"]= numLED;var reflexion=false;var blackiswait=false;var radio1directo=false;var radio2directo=false;var radio1offset=0;var radio2offset=0;var varnumrad=1;var varnumstrip=1;var numradoption=11;var chipled="";var stringcode="";var stringcode2="";var stringcode3="";var ipix=0;var x=0;var y=0;var inidice=0;var radio2180=false;var red;var green;var blue;stringcode3= "";stringcode3+= "<small>//PERSISTENCE OF VISION PROJECT";stringcode3+= "<br>//AUTHOR: JES\ufffdS VICENTE PINPANPLOT@GMAIL.COM 2017<br>//Persistence of Vision Project by Jes&uacute;s Vicente is licensed under a Creative Commons Reconocimiento 4.0 Internacional License.";stringcode3+= "<br>/////////////////////////";stringcode3+= "<br>//CONNECTIONS:";stringcode3+= "<br>//////////////////////////";stringcode3+= "<br>//HALL SENSOR IN D2 (RESISTOR 10K BETWEEN HALL SIGNAL AND HALL POSITIVE)";stringcode3+= "<br>//ARDUINO NANO AND UNO: APA102 (or similar) 'DATA' TO MOSI (D11) AND 'CLOCK' TO SCK (D13) ";stringcode3+= "<br>//ARDUINO MEGA: APA102 (or similar) 'DATA' TO MOSI (D51) AND 'CLOCK' TO SCK (D52)";stringcode3+= "<br>//NOT CONNECT APA102 REVERSED!!! (POSIBLE DAMAGE)";stringcode3+= "<br>//GND ARDUINO AND GND APA102 MUST BE CONNECTED";stringcode3+= "<br>//POWER SUPPLY OF APA102 IS EXTERNAL FROM ARDUINO";stringcode3+= "<br>//////////////////////////";stringcode3+= "<br>//////////////////////////";stringcode2+= "<br>#include &lt;avr/pgmspace.h&gt;";stringcode2+= "<br>#include \"FastLED.h\"";stringcode2+= "<br>CRGB leds[141];";stringcode2+= "<br>int angulo;";stringcode2+= "<br>unsigned int numled;";stringcode2+= "<br>unsigned int k = 0;";stringcode2+= "<br>bool pasa = false;";stringcode2+= "<br>bool cambiaLed = false;";stringcode2+= "<br>long tiempoDibujo = 0;";stringcode2+= "<br>long periodo = 0;";stringcode2+= "<br>long periodoini = 0;";stringcode2+= "<br>long previoustime = 0;";stringcode2+= "<br>long tiempo = 0;";stringcode2+= "<br>long contaseconds = 0;";stringcode2+= "<br>unsigned int ang = 360;";stringcode2+= "<br>long tvariable = 0;";stringcode2+= "<br>int tiempoescritura = 700;";stringcode2+= "<br>byte LedColour = 0;";stringcode2+= "<br>byte vred = 0;";stringcode2+= "<br>byte vgreen = 0;";stringcode2+= "<br>byte vblue = 0;";stringcode2+= "<br>int angAux = 0;";stringcode2+= "<br>int anginicio = 360;";stringcode2+= "<br>int kinicial = 0;";stringcode2+= "<br>int contaang = 0;";stringcode2+= "<br>long tiempoanimate = 0;";stringcode2+= "<br>void setup() {";stringcode2+= "<br>//Para resetear";stringcode2+= "<br>pinMode(A2, INPUT);";stringcode2+= "<br>digitalWrite(A2, LOW);";stringcode2+= "<br>FastLED.addLeds&lt;APA102&gt;(leds, pgm_read_byte(num_leds + 0) + pgm_read_byte(offset1 + 0));";stringcode2+= "<br>FastLED.setBrightness(pgm_read_byte(brillo + 0));";stringcode2+= "<br>attachInterrupt(digitalPinToInterrupt(2), pasaIman, RISING);";stringcode2+= "<br>memset(leds, 0, 141*3);";stringcode2+= "<br>FastLED.show();";stringcode2+= "<br>}";stringcode2+= "<br>void loop() {";stringcode2+= "<br>if (pasa == true) {";stringcode2+= "<br>pasa = false;";stringcode2+= "<br>tiempo = micros();";stringcode2+= "<br>periodoini = tiempo - previoustime;";stringcode2+= "<br>periodo = tiempo - previoustime - tvariable ;";stringcode2+= "<br>//periodo teorico";stringcode2+= "<br>tiempoDibujo = periodo / 360;";stringcode2+= "<br>if (tiempoDibujo < 0) tiempoDibujo = 0;";stringcode2+= "<br>previoustime = tiempo;";stringcode2+= "<br>k = 0;";stringcode2+= "<br>angulo = pgm_read_byte(PolarRedu + k);";stringcode2+= "<br>if (k / 3 >= pgm_read_word_near(angreducido + 0)) {";stringcode2+= "<br>angulo += 255;";stringcode2+= "<br>};";stringcode2+= "<br>contaang=0;";stringcode2+= "<br>for (ang = 0; ang < 360 ; ang++) {";stringcode2+= "<br>contaang++;";stringcode2+= "<br>cambiaLed = false;";stringcode2+= "<br>while (angulo == ang) {";stringcode2+= "<br>cambiaLed = true;";stringcode2+= "<br>if (pgm_read_byte(radio1directo + 0) == 1) {";stringcode2+= "<br>numled =  pgm_read_byte(PolarRedu + k+1) - 1 + pgm_read_byte(offset1 + 0);";stringcode2+= "<br>} else {";stringcode2+= "<br>//inverso es cero";stringcode2+= "<br>numled = pgm_read_byte(num_leds + 0) -  pgm_read_byte(PolarRedu + k+1) + pgm_read_byte(offset1 + 0);";stringcode2+= "<br>}";stringcode2+= "<br>LedColour =  pgm_read_byte(PolarRedu + k+2);";stringcode2+= "<br>//color option 0";stringcode2+= "<br>vred = 0;";stringcode2+= "<br>vgreen = 0;";stringcode2+= "<br>vblue = 0;";stringcode2+= "<br>if (LedColour == 4 || LedColour == 6 || LedColour == 7 || LedColour == 1) {";stringcode2+= "<br>vblue = 255;";stringcode2+= "<br>}";stringcode2+= "<br>if (LedColour == 3 || LedColour == 5 || LedColour == 6 || LedColour == 1) {";stringcode2+= "<br>vgreen = 255;";stringcode2+= "<br>}";stringcode2+= "<br>if (LedColour == 2 || LedColour == 5 || LedColour == 7 || LedColour == 1) {";stringcode2+= "<br>vred = 255;";stringcode2+= "<br>}";stringcode2+= "<br>leds[numled].r = vred;";stringcode2+= "<br>leds[numled].g = vgreen;";stringcode2+= "<br>leds[numled].b = vblue;";stringcode2+= "<br>k += 3;";stringcode2+= "<br>if (k >= pgm_read_word_near(sizePolarRedu + 0)) {";stringcode2+= "<br>  angulo = 999;";stringcode2+= "<br>}else{";stringcode2+= "<br>  angulo = pgm_read_byte(PolarRedu + k);";stringcode2+= "<br>  if (k / 3 >= pgm_read_word_near(angreducido + 0)) {";stringcode2+= "<br>    angulo += 255;";stringcode2+= "<br>  }";stringcode2+= "<br>}";stringcode2+= "<br>}";stringcode2+= "<br>if (cambiaLed == true) {";stringcode2+= "<br>FastLED.show();";stringcode2+= "<br>if (tiempoDibujo > tiempoescritura) {";stringcode2+= "<br>delayMicroseconds(tiempoDibujo - tiempoescritura);";stringcode2+= "<br>}";stringcode2+= "<br>} else {";stringcode2+= "<br>if (tiempoDibujo > tiempoescritura) {";stringcode2+= "<br>delayMicroseconds(tiempoDibujo + tiempoescritura * pgm_read_word_near(numpasos + 0) / (360 - pgm_read_word_near(numpasos + 0)));";stringcode2+= "<br>} else {";stringcode2+= "<br>delayMicroseconds(tiempoDibujo * 360 / (360 - pgm_read_word_near(numpasos + 0)));";stringcode2+= "<br>}";stringcode2+= "<br>}";stringcode2+= "<br>if (pasa == true) {";stringcode2+= "<br>//para que se sume a tvariable algo que se supone positivo";stringcode2+= "<br>tvariable += (micros() - previoustime) * 360 /contaang - periodoini;";stringcode2+= "<br>if (tvariable > 500000 || tvariable < -500000) {";stringcode2+= "<br>tvariable = 0;";stringcode2+= "<br>}";stringcode2+= "<br>return;";stringcode2+= "<br>}";stringcode2+= "<br>}";stringcode2+= "<br>//para que se sume a tvariable algo negativo";stringcode2+= "<br>tvariable += (micros() - previoustime) - periodoini;";stringcode2+= "<br>if (tvariable > 500000 || tvariable < -500000) {";stringcode2+= "<br>tvariable = 0;";stringcode2+= "<br>}";stringcode2+= "<br>}";stringcode2+= "<br>}";stringcode2+= "<br>void pasaIman () {";stringcode2+= "<br>  pasa = true;";stringcode2+= "<br>};</small>";function pixelate(v){invertir= document["getElementById"]("myCheckREV")["checked"];reflexion= document["getElementById"]("myCheckREF")["checked"];blackiswait= document["getElementById"]("myCheckWOff")["checked"];animation= document["getElementById"]("animate")["value"];vbrillo= Math["round"](parseInt(document["getElementById"]("brillo")["value"])* 255/ 100);anguloini= parseInt(document["getElementById"]("angini")["value"]);anguloini=  -anguloini;numradoption= parseInt(document["getElementById"]("numrad")["value"]);if(numradoption== 11|| numradoption== 12){varnumstrip= 1};if(numradoption== 21|| numradoption== 22){varnumstrip= 2};if(numradoption== 11|| numradoption== 21){varnumrad= 1};if(numradoption== 12|| numradoption== 22){varnumrad= 2};if(document["getElementById"]("ledtipe")["value"]== 1){chipled= "apa102"};if(document["getElementById"]("ledtipe")["value"]== 2){chipled= "ws2812b"};myImage2Polar= [];PolarRedu= [];ledColor= [];ctx2["clearRect"](0,0,c2["width"],c2["height"]);ctx["clearRect"](0,0,c1["width"],c1["height"]);if(isNaN(numpixel["value"])|| numpixel["value"]== ""){numpixel["value"]= size};size= numpixel["value"];if(size> img["naturalWidth"]){size= img["naturalWidth"];numpixel["value"]= size};if(size> img["naturalHeight"]){size= img["naturalHeight"];numpixel["value"]= size};if(size> 500){size= 500;numpixel["value"]= size};if(size< 10){size= 10;numpixel["value"]= size};w= size;h= size;ctx["drawImage"](img,0,0,w,h);myImage2= ctx["getImageData"](0,0,w,h);for(var i=0;i< w* h;i++){if(coloroption!= 11){var myGray=(myImage2["data"][(i)* 4]+ myImage2["data"][(i)* 4+ 1]+ myImage2["data"][(i)* 4+ 2])/ 3;if(myGray> 127.5|| myImage2["data"][(i)* 4+ 3]< 127.5){if(invertir){myImage2["data"][(i)* 4]= 0;myImage2["data"][(i)* 4+ 1]= 0;myImage2["data"][(i)* 4+ 2]= 0;myImage2["data"][(i)* 4+ 3]= 255;if(coloroption== 1){myImage2["data"][(i)* 4]= 255;myImage2["data"][(i)* 4+ 1]= 255;myImage2["data"][(i)* 4+ 2]= 255;myImage2["data"][(i)* 4+ 3]= 255};if(coloroption== 4|| coloroption== 6|| coloroption== 7){myImage2["data"][(i)* 4+ 2]= 255};if(coloroption== 3|| coloroption== 5|| coloroption== 6){myImage2["data"][(i)* 4+ 1]= 255};if(coloroption== 2|| coloroption== 5|| coloroption== 7){myImage2["data"][(i)* 4]= 255}}else {myImage2["data"][(i)* 4]= 0;myImage2["data"][(i)* 4+ 1]= 0;myImage2["data"][(i)* 4+ 2]= 0;myImage2["data"][(i)* 4+ 3]= 255;if(bcoloroption== 1){myImage2["data"][(i)* 4]= 255;myImage2["data"][(i)* 4+ 1]= 255;myImage2["data"][(i)* 4+ 2]= 255;myImage2["data"][(i)* 4+ 3]= 255};if(bcoloroption== 4|| bcoloroption== 6|| bcoloroption== 7){myImage2["data"][(i)* 4+ 2]= 255};if(bcoloroption== 3|| bcoloroption== 5|| bcoloroption== 6){myImage2["data"][(i)* 4+ 1]= 255};if(bcoloroption== 2|| bcoloroption== 5|| bcoloroption== 7){myImage2["data"][(i)* 4]= 255}}}else {if(invertir){myImage2["data"][(i)* 4]= 0;myImage2["data"][(i)* 4+ 1]= 0;myImage2["data"][(i)* 4+ 2]= 0;myImage2["data"][(i)* 4+ 3]= 255;if(bcoloroption== 1){myImage2["data"][(i)* 4]= 255;myImage2["data"][(i)* 4+ 1]= 255;myImage2["data"][(i)* 4+ 2]= 255;myImage2["data"][(i)* 4+ 3]= 255};if(bcoloroption== 4|| bcoloroption== 6|| bcoloroption== 7){myImage2["data"][(i)* 4+ 2]= 255};if(bcoloroption== 3|| bcoloroption== 5|| bcoloroption== 6){myImage2["data"][(i)* 4+ 1]= 255};if(bcoloroption== 2|| bcoloroption== 5|| bcoloroption== 7){myImage2["data"][(i)* 4]= 255}}else {myImage2["data"][(i)* 4]= 0;myImage2["data"][(i)* 4+ 1]= 0;myImage2["data"][(i)* 4+ 2]= 0;myImage2["data"][(i)* 4+ 3]= 255;if(coloroption== 1){myImage2["data"][(i)* 4]= 255;myImage2["data"][(i)* 4+ 1]= 255;myImage2["data"][(i)* 4+ 2]= 255;myImage2["data"][(i)* 4+ 3]= 255};if(coloroption== 4|| coloroption== 6|| coloroption== 7){myImage2["data"][(i)* 4+ 2]= 255};if(coloroption== 3|| coloroption== 5|| coloroption== 6){myImage2["data"][(i)* 4+ 1]= 255};if(coloroption== 2|| coloroption== 5|| coloroption== 7){myImage2["data"][(i)* 4]= 255}}}};if(coloroption== 11){if(invertir){if(myImage2["data"][(i)* 4]> 127.5){myImage2["data"][(i)* 4]= 0}else {myImage2["data"][(i)* 4]= 255};if(myImage2["data"][(i)* 4+ 1]> 127.5){myImage2["data"][(i)* 4+ 1]= 0}else {myImage2["data"][(i)* 4+ 1]= 255};if(myImage2["data"][(i)* 4+ 2]> 127.5){myImage2["data"][(i)* 4+ 2]= 0}else {myImage2["data"][(i)* 4+ 2]= 255};if(myImage2["data"][(i)* 4+ 3]> 127.5){myImage2["data"][(i)* 4+ 3]= 255}else {myImage2["data"][(i)* 4]= 0;myImage2["data"][(i)* 4+ 1]= 0;myImage2["data"][(i)* 4+ 2]= 0;myImage2["data"][(i)* 4+ 3]= 255}}else {if(myImage2["data"][(i)* 4]> 127.5){myImage2["data"][(i)* 4]= 255}else {myImage2["data"][(i)* 4]= 0};if(myImage2["data"][(i)* 4+ 1]> 127.5){myImage2["data"][(i)* 4+ 1]= 255}else {myImage2["data"][(i)* 4+ 1]= 0};if(myImage2["data"][(i)* 4+ 2]> 127.5){myImage2["data"][(i)* 4+ 2]= 255}else {myImage2["data"][(i)* 4+ 2]= 0};if(myImage2["data"][(i)* 4+ 3]> 127.5){myImage2["data"][(i)* 4+ 3]= 255}else {myImage2["data"][(i)* 4]= 255;myImage2["data"][(i)* 4+ 1]= 255;myImage2["data"][(i)* 4+ 2]= 255;myImage2["data"][(i)* 4+ 3]= 255}}}};if(blackiswait){for(var i=0;i< w* h;i++){if(myImage2["data"][(i)* 4]== 255&& myImage2["data"][(i)* 4+ 1]== 255&& myImage2["data"][(i)* 4+ 2]== 255&& myImage2["data"][(i)* 4+ 3]== 255){myImage2["data"][(i)* 4]= 0;myImage2["data"][(i)* 4+ 1]= 0;myImage2["data"][(i)* 4+ 2]= 0;myImage2["data"][(i)* 4+ 3]= 255}else {if(myImage2["data"][(i)* 4]== 0&& myImage2["data"][(i)* 4+ 1]== 0&& myImage2["data"][(i)* 4+ 2]== 0&& myImage2["data"][(i)* 4+ 3]== 255){myImage2["data"][(i)* 4]= 255;myImage2["data"][(i)* 4+ 1]= 255;myImage2["data"][(i)* 4+ 2]= 255;myImage2["data"][(i)* 4+ 3]= 255}}}};ctx["putImageData"](myImage2,0,0);ctx["drawImage"](c1,0,0,w,h,0,0,c1["width"],c1["height"]);capturepixel()}function numerodeLeds(){if(isNaN(idnumleds["value"])|| idnumleds["value"]== ""){idnumleds["value"]= numLED};numLED= idnumleds["value"];if(numLED> 100){numLED= 100;idnumleds["value"]= 100};if(numLED< 1){numLED= 1;idnumleds["value"]= 1};capturepixel()}function capturepixel(){myImage2Polar= [];for(var ang=0;ang< 360;ang++){myImage2Polar[ang]= []};inidice= 0;for(var ang=0;ang< 360;ang++){for(var led=1;led<= numLED;led++){var y=-h/ 2 * led / numLED * Math["sin"]((ang+ 90)* Math["PI"]/ 180) + h/ 2;if(y> h/ 2){y--};var x=w/ 2* led/ numLED* Math["cos"]((ang+ 90)* Math["PI"]/ 180)+ w/ 2;if(x> w/ 2){x--};var ipix=w* (Math["floor"](y))+ Math["floor"](x);if(reflexion== true){inidice= (360- ang+ anguloini)% 360;if(inidice< 0){inidice+= 360};myImage2Polar[inidice][led]= [];myImage2Polar[inidice][led][0]= myImage2["data"][(ipix)* 4];myImage2Polar[inidice][led][1]= myImage2["data"][(ipix)* 4+ 1];myImage2Polar[inidice][led][2]= myImage2["data"][(ipix)* 4+ 2]}else {inidice= (ang+ anguloini)% 360;if(inidice< 0){inidice+= 360};myImage2Polar[inidice][led]= [];myImage2Polar[inidice][led][0]= myImage2["data"][(ipix)* 4];myImage2Polar[inidice][led][1]= myImage2["data"][(ipix)* 4+ 1];myImage2Polar[inidice][led][2]= myImage2["data"][(ipix)* 4+ 2]}}};PolarRedu= [];var ultimoLed=0;var contaRedu=0;ledColor= [];ledColor= [];for(var i=1;i<= numLED;i++){ledColor[i]= [];ledColor[i][0]= 999;ledColor[i][1]= 999;ledColor[i][2]= 999};cambiangulo= false;numpasos= 0;anguloreducido= 999;if(radio2180){for(var ang=0;ang< 360;ang++){numpasos180[ang]= 0}};for(var ang=0;ang< 360;ang+= stepoption){for(var led=1;led<= numLED;led++){if(myImage2Polar[ang][led][0]!= ledColor[led][0]|| myImage2Polar[ang][led][1]!= ledColor[led][1]|| myImage2Polar[ang][led][2]!= ledColor[led][2]){cambiangulo= true;if(anguloreducido== 999&& ang> 255){anguloreducido= contaRedu};PolarRedu[contaRedu]= [];PolarRedu[contaRedu][0]= ang;PolarRedu[contaRedu][1]= led;PolarRedu[contaRedu][2]= myImage2Polar[ang][led][0];PolarRedu[contaRedu][3]= myImage2Polar[ang][led][1];PolarRedu[contaRedu][4]= myImage2Polar[ang][led][2];contaRedu++;ledColor[led][0]= myImage2Polar[ang][led][0];ledColor[led][1]= myImage2Polar[ang][led][1];ledColor[led][2]= myImage2Polar[ang][led][2]}};if(cambiangulo== true){numpasos++;numpasos180[ang]= 1};cambiangulo= false};if(radio2180){for(var ang=180;ang< 360;ang++){if(numpasos180[ang]== 1&& numpasos180[ang- 180]!= 1){numpasos++}}};ctx2["clearRect"](0,0,c2["width"],c2["height"]);var ledTira;var ledAcumulado=0;ledColor= [];for(var i=1;i<= numLED;i++){ledColor[i]= []};var k=0;var angAux;for(var ang=0;ang< 360;ang+= stepoption){if(k< PolarRedu["length"]){while(ang== PolarRedu[k][0]){ledColor[PolarRedu[k][1]][0]= PolarRedu[k][2];ledColor[PolarRedu[k][1]][1]= PolarRedu[k][3];ledColor[PolarRedu[k][1]][2]= PolarRedu[k][4];k++;if(k== PolarRedu["length"]){break}}};for(var i=1;i<= numLED;i++){ledTira= i;ctx2["beginPath"]();ctx2["lineWidth"]= 5;if(numLED> 40){ctx2["lineWidth"]= 4};if(numLED> 59){ctx2["lineWidth"]= 3};if(numLED> 79){ctx2["lineWidth"]= 2};if(numLED> 99){ctx2["lineWidth"]= 2};ctx2["strokeStyle"]= "rgb("+ ledColor[ledTira][0]+ ","+ ledColor[ledTira][1]+ ","+ ledColor[ledTira][2]+ ")";ctx2["arc"](c2["width"]/ 2,c2["height"]/ 2,c2["width"]/ 2* ledTira/ numLED,-(ang+ stepoption/ 2+ 90)* Math["PI"] / 180,-(ang- stepoption/ 2+ 90)* Math["PI"] / 180);ctx2["stroke"]()}};document["getElementById"]("imagen1view")["src"]= c1["toDataURL"]();document["getElementById"]("imagen1view2")["src"]= c2["toDataURL"]();escribecode()}function escribecode(){stringcode= stringcode3;stringcode+= "<br>const uint8_t chipled[] PROGMEM = {";if(chipled== "apa102"){stringcode+= "0"};if(chipled== "ws2812b"){stringcode+= "1"};stringcode+= "};";stringcode+= "<br>const  uint8_t numstrip[] PROGMEM = {";stringcode+= varnumstrip;stringcode+= "};";stringcode+= "<br>const  uint8_t numradios[] PROGMEM = {";stringcode+= varnumrad;stringcode+= "};";stringcode+= "<br>const  uint8_t radio1directo[] PROGMEM = {";if(!radio1directo){stringcode+= "1"}else {stringcode+= "0"};stringcode+= "};";stringcode+= "<br>const  uint8_t radio2directo[] PROGMEM = {";if(!radio2directo){stringcode+= "1"}else {stringcode+= "0"};stringcode+= "};";stringcode+= "<br>const  uint8_t radio2180[] PROGMEM = {";if(radio2180){stringcode+= "1"}else {stringcode+= "0"};stringcode+= "};";stringcode+= "<br>const  uint8_t offset1[] PROGMEM = {";stringcode+= radio1offset;stringcode+= "};";stringcode+= "<br>const  uint8_t offset2[] PROGMEM = {";stringcode+= radio2offset;stringcode+= "};";stringcode+= "<br>const  uint8_t brillo[] PROGMEM = {";stringcode+= vbrillo;stringcode+= "};";stringcode+= "<br>const  uint8_t animate[] PROGMEM = {";stringcode+= animation;stringcode+= "};";stringcode+= "<br>const  uint8_t num_leds[] PROGMEM = {";stringcode+= numLED;stringcode+= "};";stringcode+= "<br>const  uint16_t  numpasos[] PROGMEM = {";stringcode+= numpasos;stringcode+= "};";stringcode+= "<br>const  uint16_t  angreducido[] PROGMEM = {";stringcode+= anguloreducido;stringcode+= "};";stringcode+= "<br>const  uint16_t  sizePolarRedu[] PROGMEM = {";stringcode+= PolarRedu["length"]* 3;stringcode+= "};";stringcode+= "<br>const uint8_t PolarRedu["+ PolarRedu["length"]* 3+ "] PROGMEM = {";for(var i=0;i< PolarRedu["length"];i++){red= PolarRedu[i][2];green= PolarRedu[i][3];blue= PolarRedu[i][4];if(document["getElementById"]("redisgreen")["checked"]){red= PolarRedu[i][3]};if(document["getElementById"]("redisblue")["checked"]){red= PolarRedu[i][4]};if(document["getElementById"]("greenisred")["checked"]){green= PolarRedu[i][2]};if(document["getElementById"]("greenisblue")["checked"]){green= PolarRedu[i][4]};if(document["getElementById"]("blueisred")["checked"]){blue= PolarRedu[i][2]};if(document["getElementById"]("blueisgreen")["checked"]){blue= PolarRedu[i][3]};if(red== 0&& green== 0&& blue== 0){PolarRedu[i][5]= 0};if(red== 255&& green== 255&& blue== 255){PolarRedu[i][5]= 1};if(red== 255&& green== 0&& blue== 0){PolarRedu[i][5]= 2};if(red== 0&& green== 255&& blue== 0){PolarRedu[i][5]= 3};if(red== 0&& green== 0&& blue== 255){PolarRedu[i][5]= 4};if(red== 255&& green== 255&& blue== 0){PolarRedu[i][5]= 5};if(red== 0&& green== 255&& blue== 255){PolarRedu[i][5]= 6};if(red== 255&& green== 0&& blue== 255){PolarRedu[i][5]= 7};if(PolarRedu[i][0]<= 255){stringcode+= PolarRedu[i][0]+ ","+ PolarRedu[i][1]+ ","+ PolarRedu[i][5]}else {stringcode+= PolarRedu[i][0]- 255+ ","+ PolarRedu[i][1]+ ","+ PolarRedu[i][5]};if(i!= PolarRedu["length"]- 1){stringcode+= ","}};stringcode+= "};";stringcode+= stringcode2;document["getElementById"]("cont")["innerHTML"]= "DRAW SIZE: "+ PolarRedu["length"]* 3;document["getElementById"]("cont")["innerHTML"]+= "<br>ARDUINO NANO MAX SIZE: 15000";document["getElementById"]("cont")["innerHTML"]+= "<br>ARDUINO UNO MAX SIZE: 15000";document["getElementById"]("cont")["innerHTML"]+= "<br>MEGA UNO MAX SIZE: 30000<br>";document["getElementById"]("cont2")["innerHTML"]= stringcode}numpixel["addEventListener"]("change",pixelate,false);idnumleds["addEventListener"]("change",numerodeLeds,false);imagefile["addEventListener"]("change",readURL,false);scolor["addEventListener"]("change",functioncolor,false);bcolor["addEventListener"]("change",functioncolor,false);spaso["addEventListener"]("change",functionpaso,false);numrad["addEventListener"]("change",funcnumrad,false);ledtipe["addEventListener"]("change",functipoled,false);animate["addEventListener"]("change",funanimate,false);myinputOff1["addEventListener"]("change",functinputOff1,false);myinputOff2["addEventListener"]("change",functinputOff2,false);myCheckOpDir1["addEventListener"]("change",functCheckOpDir1,false);myCheckOpDir2["addEventListener"]("change",functCheckOpDir2,false);brillo["addEventListener"]("change",functbrillo,false);angini["addEventListener"]("change",funangini,false);$("#redisred")["change"](escribecode);$("#redisgreen")["change"](escribecode);$("#redisblue")["change"](escribecode);$("#greenisred")["change"](escribecode);$("#greenisgreen")["change"](escribecode);$("#greenisblue")["change"](escribecode);$("#blueisred")["change"](escribecode);$("#blueisgreen")["change"](escribecode);$("#blueisblue")["change"](escribecode);myCheck1802["addEventListener"]("change",functCheck1802,false);sample["addEventListener"]("change",functsample,false);function functbrillo(){if(isNaN(brillo["value"])|| brillo["value"]== ""){brillo["value"]= Math["round"](vbrillo* 100/ 255)};vbrillo= Math["round"](parseInt(document["getElementById"]("brillo")["value"])* 255/ 100);if(vbrillo> 255){vbrillo= 255;brillo["value"]= 100};if(vbrillo< 0){vbrillo= 0;brillo["value"]= 0};escribecode()}function readURL(){var input=document["getElementById"]("imagefile");if(input["files"]&& input["files"][0]){var reader= new FileReader();reader["onload"]= function(e){img=  new Image();img["onload"]= pixelate;img["src"]= e["target"]["result"]};reader["readAsDataURL"](input["files"][0])}}function functioncolor(){if((coloroption!= 11&& parseInt(document["getElementById"]("scolor")["value"])== 11)|| (bcoloroption!= 11&& parseInt(document["getElementById"]("bcolor")["value"])== 11)){document["getElementById"]("scolor")["value"]= 11;document["getElementById"]("bcolor")["value"]= 11};if(coloroption== 11&& parseInt(document["getElementById"]("scolor")["value"])!= 11|| bcoloroption== 11&& parseInt(document["getElementById"]("bcolor")["value"])!= 11){if(parseInt(document["getElementById"]("scolor")["value"])!= 11){document["getElementById"]("bcolor")["value"]= 1;if(parseInt(document["getElementById"]("scolor")["value"])== 1){document["getElementById"]("bcolor")["value"]= 0}}else {document["getElementById"]("scolor")["value"]= 0;if(parseInt(document["getElementById"]("bcolor")["value"])== 0){document["getElementById"]("scolor")["value"]= 1}}};coloroption= parseInt(document["getElementById"]("scolor")["value"]);bcoloroption= parseInt(document["getElementById"]("bcolor")["value"]);pixelate()}function functionpaso(){stepoption= parseInt(document["getElementById"]("spaso")["value"]);pixelate()}function funanimate(){if(isNaN(animate["value"])|| animate["value"]== ""){animate["value"]= animation};animation= document["getElementById"]("animate")["value"];if(animation> 45){animation= 45;document["getElementById"]("animate")["value"]= 45};if(animation< 0){animation= 0;document["getElementById"]("animate")["value"]= 0};escribecode()}function funangini(){if(isNaN(angini["value"])|| angini["value"]== ""){angini["value"]=  -anguloini};anguloini= parseInt(document["getElementById"]("angini")["value"]);if(anguloini> 360){anguloini= 360;document["getElementById"]("angini")["value"]= 360};if(anguloini<  -360){anguloini=  -360;document["getElementById"]("angini")["value"]=  -360};anguloini=  -anguloini;pixelate()}function functsample(){var string=document["getElementById"]("sample")["value"]+ ".png";img["src"]= string;img["onload"]= pixelate}function funcnumrad(){if(isNaN(numrad["value"])|| numrad["value"]== ""){numrad["value"]= numradoption};numradoption= parseInt(document["getElementById"]("numrad")["value"]);if(numradoption== 11|| numradoption== 21){document["getElementById"]("myinputOff2")["disabled"]= true;document["getElementById"]("myCheckOpDir2")["disabled"]= true;$(".c2")["hide"]();varnumrad= 1;radio2offset= 0;document["getElementById"]("myinputOff2")["value"]= 0;document["getElementById"]("myCheckOpDir2")["checked"]= false;document["getElementById"]("myCheck1802")["checked"]= false;radio2directo= false};if(numradoption== 12|| numradoption== 22){document["getElementById"]("myinputOff2")["disabled"]= false;document["getElementById"]("myCheckOpDir2")["disabled"]= false;document["getElementById"]("myCheck1802")["disabled"]= false;$(".c2")["show"]();varnumrad= 2};if(numradoption== 11|| numradoption== 12){varnumstrip= 1};if(numradoption== 21|| numradoption== 22){varnumstrip= 2};escribecode()}function functipoled(){if(document["getElementById"]("ledtipe")["value"]== 1){chipled= "apa102"};if(document["getElementById"]("ledtipe")["value"]== 2){chipled= "ws2812b"};escribecode()}function functinputOff1(){if(isNaN(myinputOff1["value"])|| myinputOff1["value"]== ""){myinputOff1["value"]= radio1offset};radio1offset= document["getElementById"]("myinputOff1")["value"];if(radio1offset> 10){radio1offset= 10;document["getElementById"]("myinputOff1")["value"]= 10};if(radio1offset< 0){radio1offset= 0;document["getElementById"]("myinputOff1")["value"]= 0};escribecode()}function functinputOff2(){if(isNaN(myinputOff2["value"])|| myinputOff2["value"]== ""){myinputOff2["value"]= radio2offset};radio2offset= document["getElementById"]("myinputOff2")["value"];if(radio2offset> 10){radio2offset= 10;document["getElementById"]("myinputOff2")["value"]= 10};if(radio2offset< 0){radio2offset= 0;document["getElementById"]("myinputOff2")["value"]= 0};escribecode()}function functCheckOpDir1(){radio1directo= document["getElementById"]("myCheckOpDir1")["checked"];escribecode()}function functCheckOpDir2(){radio2directo= document["getElementById"]("myCheckOpDir2")["checked"];escribecode()}function functCheck1801(){radio1180= document["getElementById"]("myCheck1801")["checked"];escribecode()}function functCheck1802(){radio2180= document["getElementById"]("myCheck1802")["checked"];pixelate()}